<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>POLAR AUDIO SOLUTION'S - BLACK CARD</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet" />
  <style>
    :root {
      --gold: #d8a453;
      --black: #000000;
      --orange: #fb6000;
      --white: #ffffff;
    }
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Montserrat', sans-serif;
    }
    body {
      transition: background 1s ease, color 0.5s ease;
      overflow-x: hidden;
    }
    body.dark {
      background: linear-gradient(-45deg, var(--orange), var(--black), var(--orange), var(--black));
      background-size: 400% 400%;
      animation: gradientShift 20s ease infinite;
      color: var(--white);
    }
    body.light {
      background: #ffffff;
      color: #000000;
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    .toggle-mode {
      position: fixed;
      top: 1rem;
      left: 1rem;
      z-index: 1000;
      cursor: pointer;
    }
    header {
      text-align: center;
      padding: 2rem 1rem 1rem;
    }
    header h1 {
      font-size: 2.8rem;
      color: var(--orange);
      text-shadow: 1px 1px 2px var(--black);
    }
    header h2 {
      font-size: 1.5rem;
      color: var(--gold);
    }
    .description, .card-text {
      max-width: 800px;
      margin: 2rem auto;
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.08);
      border: 1px solid rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(8px);
      border-radius: 16px;
      color: inherit;
      text-align: center;
    }
    body.light .description,
    body.light .card-text {
      background: rgba(0,0,0,0.05);
      color: #000;
    }
    .card-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 2rem;
    }
    .card {
      width: 320px;
      border-radius: 12px;
      cursor: pointer;
      transition: transform 0.4s ease;
    }
    .card:hover {
      transform: scale(1.03);
    }
    .zoom-wrapper {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      background: rgba(0,0,0,0.4);
      backdrop-filter: blur(6px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 999;
    }
    .zoom-card {
      position: relative;
    }
    .zoom-card img {
      max-width: 90vw;
      max-height: 80vh;
      border-radius: 12px;
    }
    .zoom-controls {
      position: absolute;
      top: -50px;
      right: -10px;
      display: flex;
      gap: 12px;
    }
    .zoom-controls svg,
    .toggle-mode svg {
      width: 24px;
      height: 24px;
      fill: none;
      stroke: currentColor;
      stroke-width: 2;
    }
    .zoom-controls svg {
      cursor: pointer;
    }
    .contact {
      margin: 3rem 0 1rem;
      display: flex;
      justify-content: center;
      gap: 1.5rem;
      flex-wrap: wrap;
    }
    footer {
      text-align: center;
      color: var(--gold);
      margin-bottom: 2rem;
      font-size: 0.9rem;
    }
    /* New form styles */
    .btn-getintouch {
      display: block;
      margin: 2rem auto;
      background-color: var(--orange);
      color: white;
      padding: 0.8rem 1.5rem;
      font-size: 1rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .btn-getintouch:hover {
      background-color: #e05500;
    }
    .form-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }
    .form-box {
      background-color: var(--white);
      padding: 2rem;
      border-radius: 12px;
      max-width: 500px;
      width: 90%;
      color: var(--black);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
    }
    .form-box h2 {
      color: var(--orange);
      margin-bottom: 0.5rem;
      text-align: center;
    }
    .form-box p {
      text-align: center;
      margin-bottom: 1.5rem;
      color: var(--black);
    }
    .form-box form {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }
    .form-box input,
    .form-box select,
    .form-box textarea {
      padding: 0.8rem;
      border-radius: 6px;
      border: 1px solid #ddd;
      font-size: 0.95rem;
    }
    .form-box input:focus,
    .form-box select:focus,
    .form-box textarea:focus {
      outline: none;
      border-color: var(--orange);
    }
    .card-number-input {
      display: flex;
      align-items: center;
    }
    .card-number-prefix {
      background-color: #f0f0f0;
      padding: 0.8rem;
      border-radius: 6px 0 0 6px;
      border: 1px solid #ddd;
      border-right: none;
    }
    .card-number-input input {
      border-radius: 0 6px 6px 0;
      flex-grow: 1;
    }
    .note {
      font-size: 0.8rem;
      color: #666;
      margin-top: -0.5rem;
    }
    .send-btn {
      background-color: var(--orange);
      color: white;
      padding: 0.8rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
      transition: background-color 0.3s ease;
    }
    .send-btn:hover {
      background-color: #e05500;
    }
    .cancel-btn {
      background-color: #f0f0f0;
      color: var(--black);
      padding: 0.8rem;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .cancel-btn:hover {
      background-color: #ddd;
    }
  </style>
</head>
<body class="dark">
  <div class="toggle-mode" onclick="toggleMode()">
    <!-- Light/Dark Switch Icon -->
    <svg viewBox="0 0 24 24"><path d="M12 3a9 9 0 0 0 0 18 9 9 0 0 1 0-18Z"/></svg>
  </div>

  <header>
    <h1>POLAR AUDIO SOLUTION'S</h1>
    <h2>BLACK CARD MEMBER</h2>
  </header>

  <div class="description" id="desc">
    <p>At Polar Audio Solutions, we're not just about making good sound or making stunning lighting,<br>
    we do also create systems that help your business grow and your projects stand out. We empower businesses to scale, serve, and succeed and we collaborate with businesses to create real impact.</p>
  </div>

  <div class="card-section">
    <img src="https://raw.githubusercontent.com/PolarAudio/website/main/1-min.jpg" class="card" id="card" onclick="zoomCard()" alt="Black Card Front" />

    <div class="card-text" id="cardText">
      <p>Whether you're an event company, production house, vendor, venue, professional Partner or GM.<br>
      Our BLACK CARD is your gateway to high performance solutions and long-term collaboration.</p>
      <p><strong>BLACK CARD â€“ LIMITED EDITION / B2B ONLY</strong><br>
      Exclusive for companies, corporate clients, professional partners, and GM.</p>
      <p><strong>Partner with us. Grow with us. Let's Work Together.</strong><br>
      For collaboration inquiries, contact us directly.</p>
      <div class="contact">
        <a href="https://instagram.com/polar_solution" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/instagram.svg" width="24" /></a>
        <a href="mailto:info@polarsolutionsbali.com" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/maildotru.svg" width="24" /></a>
        <a href="https://www.polarsolutionsbali.com/id" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/googlechrome.svg" width="24" /></a>
        <a href="https://wa.me/6281237858515" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/whatsapp.svg" width="24" /></a>
        <a href="https://maps.app.goo.gl/zbiZ6tRfQ24ucFsZ7" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/googlemaps.svg" width="24" /></a>
        <a href="https://facebook.com/polaraudiosolution" target="_blank"><img src="https://cdn.jsdelivr.net/gh/simple-icons/simple-icons/icons/facebook.svg" width="24" /></a>
      </div>
    </div>
  </div>

  <div class="zoom-wrapper" id="zoomWrapper">
    <div class="zoom-card">
      <div class="zoom-controls">
        <!-- Flip Icon -->
        <svg viewBox="0 0 24 24" onclick="flipCard()"><path d="M3 12h18M12 3l9 9-9 9"/></svg>
        <!-- Close Icon -->
        <svg viewBox="0 0 24 24" onclick="closeZoom()"><path d="M6 18L18 6M6 6l12 12"/></svg>
      </div>
      <img id="zoomImg" src="https://raw.githubusercontent.com/PolarAudio/website/main/1-min.jpg" alt="Zoomed Black Card" />
    </div>
  </div>

  <!-- New Get In Touch Button and Form -->
  <button onclick="showForm()" class="btn-getintouch">Get In Touch</button>
  <div id="formWrapper" style="display: none"></div>

  <footer>
    <p>Based in Bali, Indonesia<br>
    Where The Sound Meets Perfection<br>
    POLARAUDIOSOLUTION'S
    &copy; 2025</p>
  </footer>

  <script>
    let isFront = true;
    function zoomCard() {
      document.getElementById('zoomWrapper').style.display = 'flex';
      document.getElementById('cardText').style.display = 'none';
    }
    function closeZoom() {
      document.getElementById('zoomWrapper').style.display = 'none';
      document.getElementById('cardText').style.display = 'block';
    }
    function flipCard() {
      isFront = !isFront;
      document.getElementById('zoomImg').src = isFront
        ? 'https://raw.githubusercontent.com/PolarAudio/website/main/1-min.jpg'
        : 'https://raw.githubusercontent.com/PolarAudio/website/main/2-min.jpg';
    }
    function toggleMode() {
      document.body.classList.toggle('light');
      document.body.classList.toggle('dark');
    }
  </script>

  <script>
    const GS_API_URL = "https://script.google.com/macros/s/AKfycbyTKBYI2ZZZ85yMalV1LRgcSg4h3re7mL3GER8PEBBlcTh3x4sHrj8hSMR-l0lcJZ2Zwg/exec";
    const FORMSPREE_URL = "https://formspree.io/f/mnnvbjzb";
    const ADMIN_WHATSAPP_NUMBER = "6281237858515";

    function showForm() {
      if (document.getElementById("form-register")) return;

      const formHtml = `
      <div class="form-overlay" id="form-register">
        <div class="form-box">
          <h2>Get In Touch</h2>
          <p>Uncover More, With No Cost to You</p>
          <form onsubmit="return submitForm(event)">
            <input name="fullname" id="fullname" type="text" placeholder="Full Name" required />
            <input name="phone" id="phone" type="tel" placeholder="WhatsApp Number" required />
            <input name="email" id="email" type="email" placeholder="Email" required />
            
            <select name="profession" id="profession" required>
              <option value=""> Select Profession </option>
              <option value="DJ">DJ</option>
              <option value="EO">EO</option>
              <option value="GM">GM</option>
              <option value="VENDOR">VENDOR</option>
              <option value="FREELANCER">FREELANCER</option>
              <option value="OTHER">OTHER</option>
            </select>
            
            <input name="business" id="business" type="text" placeholder="Business Field" required />
            
            <select name="visa" id="visa"> 
              <option value=""> Select Type of Visa (Optional) </option>
              <option value="Tourist Visa (B211A)">Tourist Visa (B211A - Tourism, Social, Business)</option>
              <option value="Limited Stay Visa (VITAS)">Limited Stay Visa (VITAS - Work, Investor, Retirement)</option>
              <option value="Visa On Arrival (VOA)">Visa On Arrival (VOA)</option>
              <option value="Diplomatic/Service Visa">Diplomatic / Service Visa</option>
              <option value="Transit Visa">Transit Visa</option>
              <option value="Visa-Free">Visa-Free</option>
              <option value="Other">Other</option>
            </select>
            
            <div class="card-number-input">
              <span class="card-number-prefix">BK</span>
              <input name="cardnumber" id="cardnumber" type="text" placeholder="Card Number" 
                pattern="[0-9]{8}" maxlength="8" required 
                oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 8)" />
            </div>
            <div class="note">8-digit number only (e.g., BK12345678)</div>
            
            <button class="send-btn" type="submit">SUBMIT</button>
            <button class="cancel-btn" type="button" onclick="closeForm()">Cancel</button>
          </form>
        </div>
      </div>`;

      document.getElementById("formWrapper").innerHTML = formHtml;
      document.getElementById("formWrapper").style.display = "block";
    }

    function closeForm() {
      const form = document.getElementById("form-register");
      if (form) {
        form.remove();
        document.getElementById("formWrapper").style.display = "none";
      }
    }

    async function submitForm(e) {
      e.preventDefault();
      const form = e.target;
      const formData = new FormData(form);
      const data = Object.fromEntries(formData);

      // Validate card number
      const cardNumber = data.cardnumber;
      if (
        !cardNumber ||
        cardNumber.length !== 8 ||
        !/^\d+$/.test(cardNumber)
      ) {
        alert("Please enter a valid 8-digit card number (numbers only).");
        return false;
      }

      // Format card number with BK prefix for display
      const formattedCardNumber = `BK${cardNumber}`;

      let sheetsSuccess = false;
      let formspreeSuccess = false;
      let alertMessages = [];

      // Submit to Google Sheets
      try {
        const sheetsResponse = await fetch(GS_API_URL, {
          method: "POST",
          body: JSON.stringify({
            ...data,
            formattedCardNumber: formattedCardNumber,
          }),
        });
        const sheetsResult = await sheetsResponse.json();
        if (sheetsResult.status === "success") {
          sheetsSuccess = true;
          alertMessages.push(
            "Registration data saved successfully to our database."
          );
        } else {
          alertMessages.push(
            "Google Sheets submission failed: " +
              (sheetsResult.message || "Unknown error.")
          );
        }
      } catch (error) {
        alertMessages.push(
          "Google Sheets connection error: " + error.message
        );
      }

      // Submit to Formspree
      try {
        // Create new FormData to include all original fields plus the formatted card number
        const formspreeFormData = new FormData();
        formspreeFormData.append("fullname", data.fullname);
        formspreeFormData.append("phone", data.phone);
        formspreeFormData.append("email", data.email);
        formspreeFormData.append("profession", data.profession);
        formspreeFormData.append("business", data.business);
        formspreeFormData.append("visa", data.visa);
        formspreeFormData.append("cardnumber", cardNumber); // Original 8-digit number
        formspreeFormData.append("formattedCardNumber", formattedCardNumber); // With BK prefix
        formspreeFormData.append(
          "_subject",
          "New Member Registered - Polar Audio Bali"
        );

        const formspreeResponse = await fetch(FORMSPREE_URL, {
          method: "POST",
          body: formspreeFormData,
          headers: {
            Accept: "application/json",
          },
        });

        if (formspreeResponse.ok) {
          formspreeSuccess = true;
          alertMessages.push("Email notification sent successfully.");
        } else {
          const errorData = await formspreeResponse.json();
          alertMessages.push(
            "Email notification failed: " +
              (errorData.errors
                ? errorData.errors.map((err) => err.message).join(", ")
                : "Unknown error.")
          );
        }
      } catch (error) {
        alertMessages.push("Formspree connection error: " + error.message);
      }

      // Prepare WhatsApp message
      const currentTimestamp = new Date().toLocaleString("id-ID", {
        year: "numeric",
        month: "long",
        day: "numeric",
        hour: "2-digit",
        minute: "2-digit",
        second: "2-digit",
        hour12: false,
      });

      const whatsappMessage = `**POLAR AUDIO BALI - NEW MEMBER REGISTERED**
-------------------------------------------------

Registration Details:
Full Name: ${data.fullname || "N/A"}
WhatsApp Number: ${data.phone || "N/A"}
Email: ${data.email || "N/A"}
Profession: ${data.profession || "N/A"}
Business Field: ${data.business || "N/A"}
Type of Visa: ${data.visa || "N/A"}
Card Number: ${formattedCardNumber || "N/A"}

Registration Time: ${currentTimestamp}

Thank you for registering with Polar Audio Bali!`;

      const encodedWhatsappMessage = encodeURIComponent(whatsappMessage);
      const whatsappUrl = `https://wa.me/${ADMIN_WHATSAPP_NUMBER}?text=${encodedWhatsappMessage}`;

      try {
        window.open(whatsappUrl, "_blank");
        alertMessages.push(
          "WhatsApp notification will open in a new tab. Please send the message manually."
        );
      } catch (error) {
        alertMessages.push("Failed to open WhatsApp: " + error.message);
      }

      // Show all status messages
      alert(alertMessages.join("\n\n"));

      // Reset form if both submissions were successful
      if (sheetsSuccess && formspreeSuccess) {
        closeForm();
        form.reset();
      }

      return false;
    }
  </script>
</body>
</html>
